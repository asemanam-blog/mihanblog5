
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc@rsd" />
<script type="text/javascript" src="../../static.mihanblog.com/public/scripts/run/g.other.v3.js"></script>
<script>

	function c_$(id){
        return document.getElementById(id);
    }
    
			//if (parent.frames.length) top.location.href= document.location;
		
	setTodayDate = function(){
		document.write('شنبه 22 آذر 1399');
		/*354406*/	}

</script>



        <script type="text/javascript">
            (function(){
            var now = new Date();
            var head = document.getElementsByTagName('head')[0];
            var script = document.createElement('script');
            script.async = true;
            var script_address = 'https://cdn.yektanet.com/js/mihanblog.com/native-mihanblog.com-6531.js';
            script.src = script_address + '?v=' + now.getFullYear().toString() + '0' + now.getMonth() + '0' + now.getDate() + '0' + now.getHours();
            head.appendChild(script);
            })();
        </script>

        <!--<script type="text/javascript">
            var head = document.getElementsByTagName("head")[0];
            var script = document.createElement("script");
            script.type = "text/javascript";
            script.async=1;
            script.src = "https://s1.mediaad.org/serve/mihanblog.com/loader.js" ;
            head.appendChild(script);
        </script>-->
        
        <script>
            var sabaVisionWebsiteID = "9bab9dac-041d-4bdb-b39a-1ed789f65eed"; var sabaVisionWebsitePage = "ALL"
        </script>
        <link rel="stylesheet" href="https://plus.sabavision.com/dox/dox.min.css">
        <script src="https://plus.sabavision.com/dox/dox.min.js"></script>
        
        <script>
	try{
		var commentCnt = new Array();
			} catch(e){}
	
	newComment = function(post_id){
		try{
			window.open('/post/comment/'+post_id,'comment','status=yes,scrollbars=yes,toolbar=no,menubar=no,location=no ,width=480px,height=540px');
		} catch(e){}
	}
	setCommentCnt = function(post_id){
		try{
			if(commentCnt[post_id]){
				document.write(commentCnt[post_id]);
			} else {
				document.write(0);
			}
		} catch(e){}
	}
</script><script>

	statInfo = new Array();
	setStatVar = function(index,value){
		statInfo[index] = value;
	}
	getStatVar = function(index){
		if(statInfo[index]) document.write(statInfo[index]);
	}
	
	setStatVar('total_post','245');
	setStatVar('total_author','2');
	setStatVar('modify_date','دوشنبه 4 آذر 1392');
	
	setStatVar('today_view','31');
	setStatVar('yesterday_view','56');
	
	setStatVar('this_month_view','1352');
	setStatVar('last_month_view','3293');

	setStatVar('total_view','916055');
	setStatVar('last_view_date','شنبه 22 آذر 1399 (14:50)');



    
</script><script>
	messageForm = function(post_id){
		try{
			window.open('/message','message','status=yes,scrollbars=yes,toolbar=no,menubar=no,location=no ,width=480px,height=550px');
		} catch(e){}
	}
</script><script>
	linkdailyForm = function(){
		try{
			window.open('/linkdaily/new','linkdaily','status=yes,scrollbars=yes,toolbar=no,menubar=no,location=no ,width=500px,height=460px');
		} catch(e){}
	}
</script><script>

var MihanblogShopAdsArray = new Array();

function GetMihanBlogShowAds(){
	if(MihanblogShopAdsArray.length){
		var adsTarget = 'MihanblogShopAds';
		var containerWidth = document.getElementById(adsTarget).offsetWidth;
		if(containerWidth>=200){
			var adsCnt = parseInt(containerWidth / 200) ;
			if(adsCnt>MihanblogShopAdsArray.length){
				adsCnt = MihanblogShopAdsArray.length ; 
			}
//			var OneAdsWidth = parseInt(containerWidth / adsCnt) ;
			var OneAdsWidth = containerWidth / adsCnt ;
			if(OneAdsWidth>400){
				OneAdsWidth = 400 ;
			}
			var OutHtml = '';
			var img = '';
			var link = '';
			var title = '';
			var description = '';
			var imgWidth = 70;
			if(OneAdsWidth>230){
				imgWidth = 80;
			}
			if(OneAdsWidth>300){
				imgWidth = 90;
			}
			for(adsOne=0;adsOne<adsCnt;adsOne++){
				
				img = MihanblogShopAdsArray[adsOne]['img'];
				link = MihanblogShopAdsArray[adsOne]['link'];
				title = MihanblogShopAdsArray[adsOne]['title'];
				description = MihanblogShopAdsArray[adsOne]['description'];
				
				OutHtml += '<td style="background-color:#FFF;width: '+OneAdsWidth+'px;border:1px solid #f00;margin:0px 0px;font-size:11px;font-family:tahoma;padding:2px;margin:0px 0px;font-size:11px;border: 1px solid BurlyWood; padding: 1px; height: '+(imgWidth+25)+'px;">';

				OutHtml += '	<a href="http://r0b0tic.mihanblog.com/extrapage/'+link+'" target="_blank" style="text-decoration:none">';

				OutHtml += '			<div style="width: '+(OneAdsWidth-16)+'px;cursor:pointer;font-size:12px;padding: 4px 1px 4px 7px; white-space: nowrap; text-align: center; font-weight: bold; color: blue;white-space:nowrap;overflow:hidden">';
				OutHtml += 					title;
				OutHtml += '			</div>';
				OutHtml += '			<div style="cursor:pointer;padding: 1px; display: block; float: right; width: '+imgWidth+'px;">';
				OutHtml += '				<img src="'+img+'.html" style="border:0px;padding:0px;margin:0px;width:'+imgWidth+'px;height:'+imgWidth+'px;">';
				OutHtml += '			</div>';
				OutHtml += '			<div style="padding: 1px; display: block; float: right; width: '+(OneAdsWidth-13-imgWidth)+'px; text-align: right;overflow:hidden">';
				OutHtml += '				<div style="overflow:hidden;cursor:pointer;padding: 2px 3px; line-height: 17px; height: '+(imgWidth-3)+'px; text-align: justify;color:#000;direction:rtl">';
				OutHtml += 						description;
				OutHtml += '				</div>';
				OutHtml += '			</div>';

				OutHtml += '	</a>';

				OutHtml += '</td>';
			}
			
			var Out = '<table align="center" cellpadding="0" cellspacing="2" style="width:'+(OneAdsWidth*adsCnt)+'px;"><tr>'+OutHtml+'</tr></table>'; 
			
			Out = '<div style="text-align:center;padding:0px;margin:3px auto;">'+Out+'</div>'; 
			
			document.getElementById(adsTarget).style.height = (imgWidth+35)+'px' ;
			document.getElementById(adsTarget).innerHTML = Out ;
		}
	}
}
</script>
    <style>
        @font-face {
            font-family: 'Mihan-Iransans';
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans.eot');
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans.eot?') format('embedded-opentype'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans.woff2') format('woff2'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans.woff') format('woff'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'Mihan-IransansBold';
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans-Black.eot');
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans-Black.eot?') format('embedded-opentype'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans-Black.woff2') format('woff2'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans-Black.woff') format('woff'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans-Black.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'Mihan-IransansLight';
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans-UltraLight.eot');
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans-UltraLight.eot?') format('embedded-opentype'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans-UltraLight.woff2') format('woff2'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans-UltraLight.woff') format('woff'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Iransans-UltraLight.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'Mihan-Nassim';
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/Nassim.eot');
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/Nassim.eot?') format('embedded-opentype'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Nassim.woff2') format('woff2'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Nassim.woff') format('woff'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Nassim.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'Mihan-Koodak';
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/Koodak.eot');
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/Koodak.eot?') format('embedded-opentype'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Koodak.woff2') format('woff2'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Koodak.woff') format('woff'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Koodak.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'Mihan-Yekan';
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/Yekan.eot');
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/Yekan.eot?') format('embedded-opentype'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Yekan.woff2') format('woff2'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Yekan.woff') format('woff'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/Yekan.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'FontAwesome';
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/fontawesome_webfont.eot');
            src: url('http://r0b0tic.mihanblog.com/public/public/fonts/fontawesome_webfont.eot?') format('embedded-opentype'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/fontawesome_webfont.woff2') format('woff2'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/fontawesome_webfont.woff') format('woff'),
            url('http://r0b0tic.mihanblog.com/public/public/fonts/fontawesome_webfont.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }


        

        /* Smartphones (portrait and landscape) ----------- */

        /*
        @media only screen and (max-width : 480px) and (min-width : 320px) {
            .sabaClick_advert__wrapper{
                display:block;
            }
            .sabaClick_advert__inner{
                max-width: 90%;
                margin: 0 5%;
            }
        }
        */

    </style>






<P align=right><FONT color=#000080 size=3>به نام خدا<BR>با عرض سلام خدمت دوستان عزیز<BR>در این جلسه نیز مبحث <FONT color=#a52a2a>PWM</FONT> را دنبال می‌كنیم. عزیزان برای درك مطالب این جلسه حتماً باید جلسات قبل را مطالعه كرده باشند. در این جلسه به&nbsp; آی‌سی <FONT color=#a52a2a>L298</FONT> نیز اشاراتی شده است كه دوستان می‌توانند جهت یاد‌اوری، بخش مربوط به <FONT color=#a52a2a>L298</FONT> در&nbsp;<FONT color=#0000ff><U>جلسات گذشته</U></FONT>&nbsp;را نیز مرور كنند.</FONT></P>
<P align=right><FONT color=#000080 size=3>ابتدا با توابعی كه برای ایجاد وقفه در اجرای دستورات برنامه توسط <FONT color=#a52a2a>CodeVision</FONT> برای كاربران در نظر گرفته شده آشنا می‌شویم.<BR>همان‌طور كه در جلسه‌ی پیش دیدیم، در قسمت‌هایی از برنامه ممكن است نیاز پیدا كنیم تا برای لحظاتی روند اجرای دستورات را متوقف كنیم. <FONT color=#a52a2a>CodeVision</FONT> برای این كار توابعی را از پیش تنظیم كرده است. (در مورد مبحث «<FONT color=#a52a2a>توابع»</FONT> در <FONT color=#a52a2a>زبان C</FONT> در آینده مفصل توضیح خواهیم داد.)<BR></P></FONT><FONT size=3></FONT><FONT color=#000080>
<P align=right><BR></P>
<DIV align=right>
<TABLE style="WIDTH: 550px" bgColor=#d18398 align=right>
<TBODY>
<TR>
<TD><FONT color=#ffffff>delay</FONT></TD></TR></TBODY></TABLE></DIV>
<P align=right><BR><BR><BR><FONT size=3>برای ایجاد تاخیر در روند اجرای دستورات، <FONT color=#a52a2a>CodeVision</FONT> دو تابع زیر را در اختیار ما قرار داده است.<BR><BR></P></FONT>
<DIV align=right>
<TABLE dir=ltr align=right>
<TBODY>
<TR>
<TD>
<P align=left><FONT color=#000000>delay_ms( );<BR>delay_us( );</FONT></P></TD></TR></TBODY></TABLE></DIV>
<P align=right><BR><BR><BR><BR><FONT size=3>تابع<FONT color=#a52a2a> ()delay_ms</FONT> برای ایجاد تاخیر‌هایی در حد میلی ثانیه به كار می‌رود. در داخل پرانتز، یك <FONT color=#a52a2a>عدد صحیح مثبت</FONT> می‌نویسیم كه نشان دهنده‌ی اندازه‌ی تاخیر مورد نیز ما بر حسب <FONT color=#a52a2a>میلی ثانیه</FONT> است. به بیان ساده‌تر، مثلاً اگر داخل پرانتز عدد <FONT color=#a52a2a>100</FONT> را بنویسیم، روند اجرای برنامه به اندازه‌ی <FONT color=#a52a2a>100 میلی ثانیه</FONT> در همان خط متوقف خواهد شد.<BR>تابع (<FONT color=#a52a2a>)delay_us </FONT>برای ایجاد تاخیر‌هایی در حد میكروثانیه به كار می‌رود. نحوه‌ی استفاده از آن دقیقاً مانند<FONT color=#a52a2a> ()delay_ms</FONT> است.<BR>به عنوان یك مثال عملی،همان برنامه‌ی ایجاد<FONT color=#a52a2a> PWM 2.5</FONT> ولت را با استفاده از توابع <FONT color=#a52a2a>delay</FONT> بازنویسی می‌كنیم.</FONT></FONT><FONT size=3> </FONT></P>
<P align=right></P>
<P align=right><FONT size=3></FONT><FONT color=#000080></P>
<DIV align=right>
<TABLE dir=ltr align=right>
<TBODY>
<TR>
<TD>
<P align=left><FONT color=#000000>while(1)<BR>{<BR>PORTB.4=1;<BR>delay_ms(5);&nbsp;&nbsp; // 5 milliseconds delay<BR>PORTB.4=0;&nbsp;<BR>delay_ms(5);&nbsp;&nbsp;&nbsp; //5 milliseconds delay<BR>}</FONT></P></TD></TR></TBODY></TABLE></DIV>
<P align=right><BR><BR><BR><BR><BR><BR><BR><BR><BR><FONT color=#a52a2a><BR>&nbsp;</P>
<P align=right><FONT size=3></FONT></P>
<P dir=rtl align=right><FONT color=#000080><FONT size=3>تنها نكته‌ی بسیار مهم در استفاده از توابع delay اضافه كردن هِدِرفایل <FONT color=#a52a2a>Header file&nbsp;</FONT>&nbsp;باعنوان <FONT color=#a52a2a>delay.h</FONT> به برنامه است.( در مورد هدر فایل‌ها هم در آینده توضیح خواهیم داد، اما در این جلسه هیچ توضیحی در مورد آن نمی‌دهیم تا از بحث اصلی یعنی PWM منحرف نشویم.) برای این كار، جمله </FONT></P><MEGA16.H><MEGA16.H>
<P align=right><FONT size=3><IMG border=0 hspace=0 alt="" align=baseline src="http://roshd.ir/Portals/0/0and1/Robotic2/incmega16.JPG"></FONT></P>
<P dir=rtl align=right><FONT size=3>&nbsp;‌<FONT color=#a52a2a><FONT color=#000080>كه اولین جمله‌ی برنامه‌ی شما است را پیدا كنید. (این جمله را CodeWizard در برنامه‌ی شما نوشته است). حال كافیست&nbsp;این&nbsp;جمله را درست زیر ان تایپ كنید:</FONT></FONT></FONT></P>
<P dir=rtl align=right><FONT color=#a52a2a><FONT size=3><IMG border=0 hspace=0 alt="" align=baseline src="http://roshd.ir/Portals/0/0and1/Robotic2/incdelay.JPG"></FONT></P>
<P align=right><FONT color=#000000><FONT color=#000080><DELAY.H><DELAY< font><FONT size=3></FONT></FONT></P>
<P align=right><FONT size=3>دقت كنید كه این دستور نیازی به<FONT color=#a52a2a>&nbsp;« ;&nbsp;»</FONT> ندارد !!</FONT></FONT></P>
<P align=right><FONT color=#000080 size=3>با آموختن تابع <FONT color=#a52a2a>delay،</FONT> دیگر شما می‌توانید هر ولتاژی را كه می‌خواهید بر روی پایه‌های خروجی ایجاد كنید. البته دوستان دقت داشته باشند كه ولتاژی كه با تكنیك <FONT color=#a52a2a>PWM</FONT> شبیه سازی می‌شوند، در حقیقت ولتاژ خاصی نیستند و فقط شبیه سازی شده‌ی ولتاژهای مختلف هستند. هرچند كه در راه‌اندازی موتورها این تكنیك بسیار كارآمد است، اما باید دقت نظر لازم را در استفاده از این تكنیك در سایر موارد را داشته باشید.</FONT></P>
<P align=right><FONT color=#000080 size=3>همانطور كه می‌دانید موتور‌های متعارفی كه برای ساخت ربات‌ها استفاده می‌شود،ممكن است ولتاژ‌های كاری مختلفی داشته باشند (مثلاً 12ولت، 24 ولت، 6 ولت و ...) و برای راه‌اندازی آن‌ها باید از درایور‌های موتور مثل <FONT color=#a52a2a>L298</FONT> استفاده ‌كنیم.&nbsp; سوالی كه ممكن است پیش آید این است كه وقتی ما میكروكنترلر را به درایور‌های موتور(مثل <FONT color=#a52a2a>L298</FONT>) وصل می‌كنیم و از تكنیك <FONT color=#a52a2a>PWM</FONT> برای كنترل سرعت موتور استفاده می‌كنیم، چه وضعیتی پیش می‌آید؟ مثلاً وقتی ما <FONT color=#a52a2a>PWM</FONT> مربوط به ولتاژ<FONT color=#a52a2a> 2.5 ولت</FONT> را تولید می‌كنیم، درایور ما چه عكس العملی نشان می‌دهد؟ آیا ولتاژ 2.5 ولت بر روی پایه‌های موتور قرار می‌گیرد؟</FONT></P>
<P align=right><FONT color=#000080><FONT size=3>برای پاسخ دادن به این سوال باید به ساختار <FONT color=#a52a2a>PWM</FONT> دقت كنیم، ما وقتی <FONT color=#a52a2a>PWM</FONT> مربوط&nbsp; به 2.5 ولت را تولید می‌كنیم، در حقیقت سطح ولتاژ خروجی را با فواصل زمانی برابر 0 و 1 می‌كنیم، پس اگر این خروجی را، به ورودی L298 وصل كنیم(مثلاً پایه‌ی 7)، <FONT color=#a52a2a>L298</FONT> نیز موتور را با همین الگو ‌كنترل می‌كند و ولتاژی كه به موتور می‌دهد را 0 و 1&nbsp; می‌كند. و همانطور كه می‌دانید، <FONT color=#a52a2a>L298</FONT> هر ولتاژی كه بر روی پایه‌‌ی شماره‌ی 4 آن قرار گرفته باشد را بر روی موتور قرار می‌دهد(اگر ولتاژ كاری موتور 12 ولت باشد، باید این پایه به 12 ولت متصل شود) . پس جواب سوال بالا منفیست!!!&nbsp; وقتی ما <FONT color=#a52a2a>PWM</FONT> مربوط به 2.5 ولت را تولید می‌كنیم، در حقیقت سطح ولتاژ خروجی در 50 درصد زمان 1 و بقیه‌ی زمان 0 است. پس اگر همان طور كه در بالا اشاره شد، این <FONT color=#a52a2a>PWM</FONT> به درایوری مثل <FONT color=#a52a2a>L298</FONT> داده شود، و ولتاژ پایه‌ی 4 ِ آن 12ولت باشد، درایور، ولتاژ 6 ولت را به موتور می‌دهد. در نتیجه اهمیتی ندارد چه ولتاژی بر روی پایه‌ی 4 ِ L298 قرار گرفته باشد، وقتی كه ما <FONT color=#a52a2a>PWM</FONT> مربوط به 2.5 ولت را تولید می‌كنیم، درایور ولتاژی كه به موتور می‌دهد را 50 درصد می‌كند. در نتیجه بهتر است از این به بعد به جای آن كه بگوییم <FONT color=#a52a2a>PWM</FONT> مربوط به 2.5 ولت، بگوییم <FONT color=#a52a2a>PWM</FONT><FONT color=#ffffff>ااا</FONT><FONT color=#a52a2a>50 درصد</FONT><FONT color=#000080>.</FONT>&nbsp;یا به جای <FONT color=#a52a2a>PWM</FONT> ِمربوط به 1 ولت، بگوییم <FONT color=#a52a2a>PWM</FONT><FONT color=#ffffff>ااا</FONT><FONT color=#a52a2a>20 درصد</FONT></FONT></FONT></P><FONT color=#000080><FONT size=3>
<P align=right><BR></P></FONT>
<P align=right><FONT size=3></FONT></P>
<DIV align=right>
<TABLE style="WIDTH: 550px" bgColor=#d18398 align=right>
<TBODY>
<TR>
<TD><FONT color=#ffffff>PWM در میكروكنترلر‌های AVR</FONT></TD></TR></TBODY></TABLE></DIV>
<P align=right><FONT size=3></FONT></P>
<P align=right><BR><BR><BR><FONT size=3>انجام تنظیمات اولیه برای استفاده از <FONT color=#a52a2a>PWM</FONT> برای راه اندازی موتور درمیكروكنترلر‌های <FONT color=#a52a2a>AVR</FONT> كمی پیچیده است، اما در اینجا هم <FONT color=#a52a2a>CodeWizard</FONT> به كمك ما آمده است و كار را كمی ساده‌تر كرده است. ما در جلسه‌ی آینده&nbsp; بخشی از تنظیمات <FONT color=#a52a2a>CodeWizard</FONT> را بدون توضیح مطرح می‌نماییم، زیرا توضیح هر بخش از آن نیازمند مقدمات مفصلی است و تاثیر چندانی هم در روند كار ما ندارد، اما به دوستانی كه می‌خواهند میكروكنترلر را كاملاً حرفه‌ای دنبال كنند، پیشنهاد می‌كنم از منابعی كه قبلاً معرفی شده است، مطالب را تكمیل كنند. <BR>به هر حال دوستان عزیز با انجام این تنظیمات اولیه‌ی مختصر در <FONT color=#a52a2a>CodeWizard،</FONT> می‌توانند از الگویی به مراتب ساده‌تر از آنچه تا به حال آموخته‌ایم، برای ایجاد <FONT color=#a52a2a>PWM</FONT> برای هدایت موتورهای ربات استفاده نمایند.</FONT></FONT></P>
<P align=right><FONT color=#000080><FONT size=3>در میكروكنترلر‌های خانواده‌ی <FONT color=#a52a2a>AVR</FONT>، نیازی نیست در هربار استفاده از <FONT color=#a52a2a>PWM</FONT> ، چندین خط برنامه بنویسیم.&nbsp; در <FONT color=#a52a2a>ATmega16</FONT> چهارپایه‌ی مشخص از آی سی به این موضوع اختصاص داده شده است. یعنی این&nbsp;چهارپایه علاوه بر كاربرد‌های معمولی خود، این قابلیت را دارند كه در مواقع لزوم برای تولید <FONT color=#a52a2a>PWM</FONT> استفاده شوند.<BR>حال سوال اینجاست كه این چهارپایه چه تفاوتی با بقیه‌ی پایه‌های خروجی آی‌سی دارند كه آن‌ها را از سایر پایه‌های خروجی میكروكنترلر متمایز می‌سازد؟ <BR>برای این چهارپایه نیازی به اجرای الگویی كه تا به حال برای ایجاد <FONT color=#a52a2a>PWM</FONT> فراگرفته‌اید نیست. در این روش، فقط&nbsp; شما باید <FONT color=#a52a2a>یك عدد صحیح بین 0 تا 255 </FONT>انتخاب كنید، و طبق الگوی زیر آن را در برنامه‌ی خود بنویسید. <BR></FONT><FONT color=#a52a2a><STRONG><BR></STRONG></FONT><BR></P>
<P style="TEXT-ALIGN: left; unicode-bidi: embed; DIRECTION: ltr" align=right><FONT color=#a52a2a><FONT size=3><B>یك عدد صحیح بین 0 تا 255 = نام رجیستر مربوطه‌</B><B>&nbsp; ;</B></FONT></FONT></P>
<P align=right><FONT size=3>این عدد، بیانگر توان <FONT color=#a52a2a>PWM</FONT> شماست، و&nbsp; شما توان <FONT color=#a52a2a>PWM</FONT> ِ مورد نیاز خود را با این عدد مشخص می‌كنید. كه 255 بالاترین توان و مربوط به<FONT color=#a52a2a>PWM</FONT><FONT color=#ffffff>ااا</FONT><FONT color=#a52a2a>100 درصد</FONT>است، و&nbsp; 0 پایین‌ترین توان و مربوط به <FONT color=#a52a2a>PWM</FONT><FONT color=#ffffff>ااا</FONT><FONT color=#a52a2a>0 درصد</FONT> است. <BR>به عنوان مثال اگر این عدد را&nbsp; 128 قرار دهید، همان <FONT color=#a52a2a>PWM</FONT><FONT color=#ffffff>ااا</FONT><FONT color=#a52a2a>50 درصد </FONT>را ایجاد كرده‌اید. یا مثلا اگر این عدد 51 باشد، <FONT color=#a52a2a>PWM</FONT><FONT color=#ffffff>ااا</FONT><FONT color=#a52a2a>20 درصد </FONT>بر روی پایه قرار داده‌اید.</FONT></FONT></P><FONT color=#000080><FONT size=3>
<P align=right><BR></P></FONT>
<P align=right><FONT size=3></FONT></P>
<DIV align=right>
<TABLE style="WIDTH: 550px" bgColor=#d18398 align=right>
<TBODY>
<TR>
<TD><FONT color=#ffffff>رجیستر‌های مربوط به این 4 پایه</FONT></TD></TR></TBODY></TABLE></DIV>
<P align=right><FONT size=3></FONT></P>
<P align=right><BR><BR><BR><FONT size=3>همانطور كه می‌دانید، برای پایه‌هایی كه در <FONT color=#a52a2a>CodeWizard</FONT> به صورت خروجی تعریف شده‌اند، رجیستری به نام <FONT color=#a52a2a>«PORTx»</FONT> وجود دارد كه هر مقداری در این رجیستر قرار داده ‌شود، مقدار پایه‌های خروجی متناظر با آن رجیستر را مشخص می‌كند.(رجوع به جلسه‌ی 24،تعریف رجیستر <FONT color=#a52a2a>PORTx</FONT>).<BR>در این جلسه با 4 رجیستر دیگر آشنا می‌شویم، كه وقتی تنظیمات مربوط به <FONT color=#a52a2a>PWM</FONT> ِ موتور در <FONT color=#a52a2a>CodeWizard</FONT> را انجام&nbsp; دهیم، هر مقداری كه در‌ آن‌ها ریخته شود، توان <FONT color=#a52a2a>PWM</FONT> پایه‌ی متناظر را مشخص می‌كنند. <BR>این رجیستر‌ها <FONT color=#a52a2a>OCR0، OCR1AL، OCR1BL و OCR2</FONT> نام دارند كه به ترتیب، متناظر پایه‌های<FONT color=#a52a2a> PB.3، PD.5، PD.4&nbsp; و PD.7‌</FONT> هستند.<BR>پس مثلاً اگر در بخشی از برنامه‌ی خود بنویسیم :<BR></P></FONT>
<P align=right><FONT size=3></FONT></P>
<DIV align=right>
<TABLE dir=ltr align=right>
<TBODY>
<TR>
<TD>
<P align=left><FONT color=#000000>OCR0=127;&nbsp;</FONT></P></TD></TR></TBODY></TABLE></DIV>
<P align=right><BR><BR><FONT size=3>در حقیقت بر روی پایه‌ی<FONT color=#a52a2a> PB.3</FONT> میكروكنترلر، <FONT color=#a52a2a>PWM</FONT><FONT color=#ffffff>ااا</FONT><FONT color=#a52a2a>50-درصد </FONT>به وجود آورده‌ایم.<BR><BR>به مثال‌های دیگری توجه كنید: (توضیح هر دستور در جلوی دستور و&nbsp; بعد از // آورده شده است) </FONT></P>
<P align=right></P>
<P align=right><FONT size=3></FONT></P>
<DIV align=right>
<TABLE dir=ltr align=right>
<TBODY>
<TR>
<TD>
<P align=left><FONT color=#000000>OCR1AL=51;&nbsp;// 20% Duty Cycle on PD.5<BR>OCR1BL=255;&nbsp;//100% Duty Cycle on PD.4<BR>OCR2=0;&nbsp;&nbsp;//0% Duty Cycle on PD.7</FONT></P></TD></TR></TBODY></TABLE></DIV>
<P align=right><FONT size=3></FONT></P><FONT size=3>
<P align=right><BR></P></FONT></FONT><FONT color=#000080>
<P align=right><BR><BR><BR><BR><FONT size=3>در&nbsp;ادامه در مورد نحوه‌ی انجام تنظیمات اولیه‌ جهت تولید <FONT color=#a52a2a>PWM</FONT> در <FONT color=#a52a2a>CodeWizard</FONT> را توضیح خواهیم داد.</FONT></P>
<P align=right><FONT color=#4b0082 size=3>همانطور كه گفتیم ، در اینجا مجال نیست تا تمام مباحث مربوط به <FONT color=#a52a2a>PWM</FONT> و تایمرها را باز كنیم و مفصل به آن‌ها بپردازیم، به همین خاطر در این جلسه قسمتی از تنظیمات در <FONT color=#a52a2a>CodeWizard</FONT> را بدون توضیح آموزش می‌دهیم.<BR>برای انجام تنظیمات به كمك <FONT color=#a52a2a>CodeWizard</FONT>، ابتدا باید طبق روندی كه در<FONT color=#0000ff> جلسات گذشته</FONT>&nbsp;توضیح داده شد، یك پروژه‌ی جدید در <FONT color=#a52a2a>CodeVision</FONT> بسازید.<BR>پس از انجام تنظیمات سایر لبه‌ها (مانند Ports، Chip و .... ) در <FONT color=#a52a2a>CodeWizard</FONT>، لبه‌ی <FONT color=#a52a2a>Timers</FONT> را باز كنید.<BR>&nbsp;همانطور كه می‌بینید میكروكنترلر <FONT color=#a52a2a>ATmega16</FONT> دارای 3 تایمر مجزا است و ما برای تولید <FONT color=#a52a2a>PWM</FONT> باید از این تایمرها استفاده كنیم. تایمر‌ها كاربرد‌ها‌ی متعددی دارند، و یكی از مهم‌ترین مباحث در میكروكنترلر هستند، ما هم&nbsp; در مورد تایمر‌ها در جلسات آینده مفصل توضیح خواهیم داد. اما در این جلسه فقط استفاده از تایمر‌ها را برای ایجاد <FONT color=#a52a2a>PWM</FONT> برای كنترل موتور‌های ربات استفاده می‌كنیم.<BR></P></FONT><FONT size=3></FONT><FONT color=#4b0082>
<P align=right><BR></P>
<P align=right></P>
<DIV align=right>
<TABLE style="WIDTH: 550px" cellSpacing=0 align=right>
<TBODY>
<TR>
<TD bgColor=#8b0000><FONT color=#ffffff>Timer0</FONT></TD></TR>
<TR style="HEIGHT: 5px">
<TD style="FONT-SIZE: 0px" bgColor=#ffa500><FONT size=3>&nbsp;</FONT></TD></TR></TBODY></TABLE></DIV>
<P align=right><BR><BR><BR><FONT size=3>Timer0 مربوط به رجیستر <FONT color=#a52a2a>OCR0</FONT> است و باید به شكل زیر تنظیم شود.<BR></P></FONT></FONT>
<P align=right></P>
<P align=right><FONT size=3></FONT></P>
<P align=right><FONT size=3><IMG border=0 hspace=0 alt="" align=baseline src="http://roshd.ir/portals/0/0and1/robotic2/timer0.jpg"></FONT></P>
<P align=right><FONT color=#4b0082 size=3>نكته‌ای كه در مورد تنظیم هر 3 تایمر باید رعایت شود، این است كه در بخش <FONT color=#a52a2a>"Clock Value"</FONT> باید پایین‌ترین فركانس را انتخاب كنید. در این مورد توضیح مختصری می‌دهم، ولی اگر عزیزان این بند را متوجه نشوند اهمیت زیادی ندارد: اندازه‌ی فركانسی&nbsp; كه انتخاب می‌كنید در این بخش، در حكم اندازه‌ی همان Delayهایی است كه برای تولید <FONT color=#a52a2a>PWM</FONT> به صورت عادی (كه در ابتدای جلسه‌ی قبل توضیح دادیم) استفاده می‌كنیم. یعنی در حقیقت طول موج را در نمودار ولتاژ بر زمان تعیین می‌كند. هر چه فركانس بالاتری را انتخاب كنید، طول موج كمتر می‌شود. در عمل دیده شده كه هر چه فركانس پایین‌تر باشد و در نتیجه طول موج بیشتر باشد، موتور‌ها بهتر هدایت می‌شوند. به همین خاطر در بالا گفته شد كه دوستان پایین‌ترین فركانس را برای <FONT color=#a52a2a>"Clock Value"</FONT> انتخاب كنند.<BR></P></FONT><FONT size=3></FONT><FONT color=#4b0082>
<P align=right><BR></P>
<P align=right></P>
<DIV align=right>
<TABLE style="WIDTH: 550px" cellSpacing=0 align=right>
<TBODY>
<TR>
<TD bgColor=#8b0000><FONT color=#ffffff>Timer1</FONT></TD></TR>
<TR style="HEIGHT: 5px">
<TD style="FONT-SIZE: 0px" bgColor=#ffa500><FONT size=3>&nbsp;</FONT></TD></TR></TBODY></TABLE></DIV>
<P align=right><BR><BR><BR><FONT size=3>تایمر1 باید به شكل زیر تنظیم شود. دقت كنید كه ممكن است در بخش<FONT color=#a52a2a> Clock Value</FONT> شما فركانسی كه در شكل زیر نمایش داده شده است را در گزینه‌ها نداشته باشید، ولی همانطور كه گفته شد فقط مهم این است كه شما پایین‌ترین فركانس را انتخاب كنید.<BR></P></FONT>
<P align=right></P>
<P align=right><FONT size=3></FONT></P>
<P align=right><FONT size=3><IMG border=0 hspace=0 alt="" align=baseline src="http://roshd.ir/portals/0/0and1/robotic2/timer1.jpg"></FONT></P>
<P align=right><BR><FONT size=3>همانطور كه می‌بینید، تایمر1 دارای دو خروجی مجزا است كه رجیستر‌های مربوط به آن‌ها <FONT color=#a52a2a>OCR1AL</FONT> و <FONT color=#a52a2a>OCR1BL</FONT> هستند.<BR><BR><BR></P></FONT></FONT>
<P align=right><FONT size=3></FONT><FONT color=#4b0082></P>
<P align=right></P>
<DIV align=right>
<TABLE style="WIDTH: 550px" cellSpacing=0 align=right>
<TBODY>
<TR>
<TD bgColor=#8b0000><FONT color=#ffffff>Timer2</FONT></TD></TR>
<TR style="HEIGHT: 5px">
<TD style="FONT-SIZE: 0px" bgColor=#ffa500><FONT size=3>&nbsp;</FONT></TD></TR></TBODY></TABLE></DIV>
<P align=right><BR><BR><BR><FONT size=3>تایمر2 میز به شكل زیر تنظیم می‌شود و مانند تایمر0 فقط یك خروجی دارد.<BR></P></FONT>
<P align=right></P>
<P align=right><FONT size=3></FONT></P>
<P align=right><FONT size=3><IMG border=0 hspace=0 alt="" align=baseline src="http://roshd.ir/portals/0/0and1/robotic2/timer2.jpg"></FONT></P><FONT size=3>
<P align=right><BR></P></FONT>
<P align=right></P>
<DIV align=right>
<TABLE style="WIDTH: 550px" align=right>
<TBODY>
<TR>
<TD bgColor=#8b0000><FONT color=#ffffff>Watchdog</FONT></TD></TR>
<TR style="HEIGHT: 5px">
<TD style="FONT-SIZE: 0px" bgColor=#ffa500><FONT size=3>&nbsp;</FONT></TD></TR></TBODY></TABLE></DIV>
<P align=right><BR><BR><BR><FONT size=3>&nbsp;یا سگ نگهبان نیز یكی از مباحث مربوط به تایمر‌هاست كه در جلسات آینده به آن خواهیم پرداخت.</FONT></FONT><FONT color=#000000 size=3> </FONT></P>
<P align=right></P>
<P align=right><FONT size=3></FONT></P>
<P align=right><FONT color=#4b0082 size=3>حال كه همه‌ی تنظیمات لازم را در <FONT color=#a52a2a>CodeWizard</FONT> انجام داده‌اید، <FONT color=#a52a2a>"Generate, Save and Exit"</FONT> انتخاب كنید و وارد فضای برنامه نویسی شوید.</FONT></P>
<P align=right><FONT size=3></FONT><FONT color=#4b0082></P>
<P align=right></P>
<DIV align=right>
<TABLE style="WIDTH: 550px" bgColor=#f1e6e2 align=right>
<TBODY>
<TR>
<TD>
<P align=justify><FONT color=#4b0082><STRONG><FONT color=#ff0000>نكته‌ی بسیار مهم:<BR></FONT></STRONG>برای كنترل هر موتور، علاوه بر یك پایه‌ی </FONT><FONT color=#a52a2a>PWM،</FONT><FONT color=#4b0082> یك خروجی معمولی نیز لازم داریم تا بتوانیم به وسیله‌ی این دو پایه و به كمك درایور موتور، اختلاف پتانسیل مورد نظر را بر روی دو پایه‌ی موتور برقرار كنیم. این 2 پایه را به دو پایه‌ی ورودی </FONT><FONT color=#a52a2a>L298</FONT><FONT color=#4b0082> متصل می‌كنیم و دو پایه‌ی موتور را نیز، به دو پایه‌ی خروجی&nbsp; </FONT><FONT color=#a52a2a>L298</FONT><FONT color=#4b0082> متصل می‌كنیم. حال می‌توانیم موتور را به وسیله‌ی میكروكنترلر با سرعت دلخواه كنترل كنیم. به عنوان مثال اگر بخواهیم موتور ما تقریباً با سرعت نصف بچرخد، و پایه‌های </FONT><FONT color=#a52a2a>PD.6</FONT><FONT color=#4b0082> و&nbsp;</FONT><FONT color=#a52a2a>PD.7 </FONT><FONT color=#4b0082>(مربوط به رجیستر </FONT><FONT color=#a52a2a>OCR2</FONT><FONT color=#4b0082>) را به </FONT><FONT color=#a52a2a>L298</FONT><FONT color=#4b0082> متصل كرده باشیم،برنامه‌ی زیر را باید بنویسیم:<BR><BR></P>
<TABLE align=left>
<TBODY dir=ltr>
<TR>
<TD>
<P align=left><FONT color=#000000>OCR2=127;<BR>PORTD.6=0; </FONT></P></TD></TR></TBODY></TABLE><BR></FONT>
<P></P>
<P align=justify><FONT color=#4b0082>و اگر بخواهیم موتور ما با همین سرعت و در جهت معكوس بچرخد، می‌نویسیم:<BR><BR></FONT></P>
<TABLE align=left>
<TBODY dir=ltr>
<TR>
<TD><FONT color=#4b0082>OCR2=127;<BR>PORTD.6=1;</FONT></TD></TR></TBODY></TABLE><BR><BR><BR><BR><FONT color=#4b0082>برای درك این موضوع دقت كنید كه در این حالت چه ولتاژی توسط L298 بر روی موتورها قرار داده می‌شود. همانطور كه می‌دانید، سرعت و جهت چرخش موتور وابسته به اختلاف ولتاژی است كه بر روی پایه‌های موتور قرار داده می‌شود. </FONT>
<P></P></TD></TR></TBODY></TABLE></DIV>
<P align=right><BR>&nbsp;</P></FONT>
<P align=right></P>
<P align=right><FONT color=#4b0082 size=3></FONT></P>
<P align=right><FONT color=#4b0082 size=3>تا به اینجا مباحث پایه‌ای در میكروكنترلر‌های <FONT color=#a52a2a>AVR</FONT>&nbsp;مطرح شده است و همین آموخته‌های دوستان، نیاز‌های اولیه‌ی شما عزیزان را برای ساخت ربات‌های نسبتاً حرفه‌ای برطرف می‌سازد.<BR>از این به بعد، مطالب به با دامنه‌ی گسترده‌تری پیرامون سایر مباحث مربوط به رباتیك،ارائه خواهد شد. در هر جلسه مطلب جدیدی را مطرح كرده و در مورد آن توضیح می‌دهیم و دیگر مطالب به شكل كنونی به صورت زنجیره‌وار و وابسته به هم، نخواهند بود.<BR>&nbsp;طبیعتاً برای درك هر مطلبی نیاز به مقدمات و پیش‌نیازهایی است، كه در ابتدای هر جلسه&nbsp; پیش نیاز‌های مطالبی كه در ان جلسه قرار است مطرح شوند، ذكر خواهد شد، تا به این ترتیب پراكندگی مطالب، دوستان را دچار سر در گمی نكند.</FONT></P>
<P align=right><FONT color=#4b0082 size=3>مجدداً از دوستان عزیزی كه مخاطب این بخش هستند و مطالب را با ما دنبال می‌كنند، تقاضا می‌شود هر پیشنهاد و انتقادی برای ارتقا سطح كیفی این بخش دارند، با ما در میان بگذارند.</FONT></P>
<P align=right><FONT color=#4b0082 size=3>تا جلسه‌ی آینده خدا نگه‌دار.<BR></P></FONT></FONT></FONT></FONT></FONT></FONT><script>
//    setTimeout(function () {
//        GetMihanBlogShowAds();
//    }, 1000);
</script>
<!--NEW SERVER--><!--;)-->

<!--SabaVision Ads Handler--><!--<script type="text/javascript">(function (d) {var url =   location.protocol+'//api.sabavision.com/pox/poxjs.js';d.write('<script type="text/javascript" src="' + url + '" async></scri' + 'pt>');})(document);</script>-->


<script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-153829-9']);
    _gaq.push(['_setDomainName', 'r0b0tic.mihanblog.com']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

</script>


<div id='mediaad-Kvcm'></div>
<meta name="sabavision_zone" content="2500-Z499" />
<center>
    <div style="background-color:white;width:90%;padding:20px;margin-top:50px;margin-bottom:50px;">
        <a href="https://www.cloob.com">شبکه اجتماعی فارسی کلوب</a> | <a href="https://www.seo25.com/product/buy-mobile-traffic-and-get-cheap-targeted-mobile-traffic/" target="_blank">Buy Mobile Traffic</a> | <a href="https://www.soalaat.com">سایت سوالات</a>
    </div>
</center>
